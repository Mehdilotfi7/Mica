<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorials ¬∑ TSCPDetector.jl</title><meta name="title" content="Tutorials ¬∑ TSCPDetector.jl"/><meta property="og:title" content="Tutorials ¬∑ TSCPDetector.jl"/><meta property="twitter:title" content="Tutorials ¬∑ TSCPDetector.jl"/><meta name="description" content="Documentation for TSCPDetector.jl."/><meta property="og:description" content="Documentation for TSCPDetector.jl."/><meta property="twitter:description" content="Documentation for TSCPDetector.jl."/><meta property="og:url" content="https://Mehdilotfi7.github.io/TSCPDetector.jl/tutorial.html"/><meta property="twitter:url" content="https://Mehdilotfi7.github.io/TSCPDetector.jl/tutorial.html"/><link rel="canonical" href="https://Mehdilotfi7.github.io/TSCPDetector.jl/tutorial.html"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">TSCPDetector.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="getting_started.html">Getting started</a></li><li><a class="tocitem" href="problems.html">Problem types</a></li><li class="is-active"><a class="tocitem" href="tutorial.html">Tutorials</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Methodological-Foundation"><span>Methodological Foundation</span></a></li><li><a class="tocitem" href="#Problem-Formulation"><span>Problem Formulation</span></a></li><li><a class="tocitem" href="#Architecture"><span>Architecture</span></a></li><li><a class="tocitem" href="#Chromosome-Structure-in-Optimization"><span>Chromosome Structure in Optimization</span></a></li><li><a class="tocitem" href="#Iterative-Process"><span>Iterative Process</span></a></li><li><a class="tocitem" href="#Penalty-Functions"><span>Penalty Functions</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="examples.html">Examples</a></li><li><a class="tocitem" href="loss_function.html">Custom Loss Functions for Segment Evaluation</a></li><li><a class="tocitem" href="references.html">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="tutorial.html">Tutorials</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tutorial.html">Tutorials</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Mehdilotfi7/TSCPDetector.jl/blob/main/docs/src/tutorial.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial:-Understanding-Mocha&#39;s-Changepoint-Detection-Algorithm"><a class="docs-heading-anchor" href="#Tutorial:-Understanding-Mocha&#39;s-Changepoint-Detection-Algorithm">Tutorial: Understanding Mocha&#39;s Changepoint Detection Algorithm</a><a id="Tutorial:-Understanding-Mocha&#39;s-Changepoint-Detection-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial:-Understanding-Mocha&#39;s-Changepoint-Detection-Algorithm" title="Permalink"></a></h1><p>This tutorial provides a detailed, step-by-step walkthrough of Mocha&#39;s methodology for detecting changepoints in time series data. It is designed to help you understand not only how to use the package but also how the underlying algorithm works.</p><blockquote><p>üí° <strong>Note:</strong> This tutorial is based on an ODE (Ordinary Differential Equation) model to illustrate the core concepts. However, the underlying methodology‚Äîsegmentation, optimization, and changepoint detection‚Äîapplies equally to all model types supported by Mocha.jl, including difference equations and regression models.</p></blockquote><hr/><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Mocha detects changepoints in time-dependent systems by analyzing shifts in model parameters instead of raw statistical properties like mean or variance. The core idea is to fit a piecewise model where each segment has its own parameters, allowing detection of structural changes in the underlying system.</p><hr/><h2 id="Methodological-Foundation"><a class="docs-heading-anchor" href="#Methodological-Foundation">Methodological Foundation</a><a id="Methodological-Foundation-1"></a><a class="docs-heading-anchor-permalink" href="#Methodological-Foundation" title="Permalink"></a></h2><p>Mocha is designed around <strong>Piecewise Switching ODEs (PSODEs)</strong>, where a time series is assumed to be governed by different parameter regimes across segments. It generalizes a standard ODE:</p><p class="math-container">\[\frac{dy}{dt} = f(y,t,p)\]</p><p>into a segmented system:</p><p class="math-container">\[\frac{dy}{dt} = \sum_{i=1}^{k + 1} \mathbf{1}_{\{t_{i-1} \leq t &lt; t_i\}} f_i(y,t, NSP, SP_i)\]</p><ul><li><strong>NSP</strong>: Non-segment-specific parameters (global across all segments)</li><li><strong>SP_i</strong>: Segment-specific parameters for segment <code>i</code></li><li><strong>t_i</strong>: Change points that separate the segments</li></ul><p>The model guarantees <strong>continuity</strong> across segments by ensuring:</p><p class="math-container">\[y(t_i^-) = y(t_i^+)\]</p><p>This way, Mocha inherits the mathematical guarantees of traditional ODE theory within each segment.</p><hr/><h2 id="Problem-Formulation"><a class="docs-heading-anchor" href="#Problem-Formulation">Problem Formulation</a><a id="Problem-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Formulation" title="Permalink"></a></h2><p>Formally, Mocha formulates changepoint detection as a model selection problem:</p><p class="math-container">\[V(CPs, y) = \sum_{i=1}^{k} c\left(x_{t_{i-1} \dots t_i}\right) + \text{penalty}\]</p><p>Where:</p><ul><li><code>CPs</code>: Change points to detect</li><li><code>c(...)</code>: Cost function comparing model simulation vs. observed data in each segment</li><li><code>penalty</code>: Term to prevent overfitting (too many change points)</li></ul><hr/><h2 id="Architecture"><a class="docs-heading-anchor" href="#Architecture">Architecture</a><a id="Architecture-1"></a><a class="docs-heading-anchor-permalink" href="#Architecture" title="Permalink"></a></h2><p><img src="fig/flowchart.png" alt="Mocha Flowchart"/></p><p>Algorithm Flowchart Summary: The algorithm follows a modular, iterative structure with three key blocks:</p><ul><li><p>Block 1 ‚Äì Optimization Module: Solves the model over the full data and calculates baseline cost assuming no change points.</p></li><li><p>Block 2 ‚Äì Segmentation Module: Proposes potential change points using binary segmentation and evaluates candidate splits.</p></li><li><p>Block 3 ‚Äì Chromosome Updating: If a change point improves model fit, the chromosome is updated to include new segment-specific parameters. The process continues until no further improvement is observed.</p></li></ul><p>The algorithm consists of three modules:</p><h3 id="1.-Segmentation-Module-(Propose-Candidates)"><a class="docs-heading-anchor" href="#1.-Segmentation-Module-(Propose-Candidates)">1. Segmentation Module (Propose Candidates)</a><a id="1.-Segmentation-Module-(Propose-Candidates)-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Segmentation-Module-(Propose-Candidates)" title="Permalink"></a></h3><ul><li>Uses a modified binary segmentation.</li><li>Scans the data from start to end (forward pass) and end to start (backward pass).</li><li>Ensures each proposed segment satisfies minimum length constraints.</li></ul><h3 id="2.-Optimization-Module-(Validate-Candidates)"><a class="docs-heading-anchor" href="#2.-Optimization-Module-(Validate-Candidates)">2. Optimization Module (Validate Candidates)</a><a id="2.-Optimization-Module-(Validate-Candidates)-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Optimization-Module-(Validate-Candidates)" title="Permalink"></a></h3><ul><li>Uses a <strong>genetic algorithm (GA)</strong> to optimize model parameters.</li><li>The GA evolves chromosomes representing the parameters.</li><li>The structure is updated as new change points are added.</li></ul><h3 id="3.-Interaction-Layer"><a class="docs-heading-anchor" href="#3.-Interaction-Layer">3. Interaction Layer</a><a id="3.-Interaction-Layer-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Interaction-Layer" title="Permalink"></a></h3><ul><li><p>Orchestrates the process:</p><ul><li>Evaluates full model loss for proposed changepoints.</li><li>If a candidate improves fit (minus penalty), it is accepted.</li><li>Updates chromosome and restarts on new segments.</li></ul></li></ul><hr/><h2 id="Chromosome-Structure-in-Optimization"><a class="docs-heading-anchor" href="#Chromosome-Structure-in-Optimization">Chromosome Structure in Optimization</a><a id="Chromosome-Structure-in-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Chromosome-Structure-in-Optimization" title="Permalink"></a></h2><p>The genetic algorithm uses a chromosome split into:</p><ul><li>Global parameters (NSP)</li><li>Parameters for each segment (SP_i)</li></ul><p>As new change points are added, the chromosome dynamically expands:</p><pre><code class="language-text hljs">[NSP | SP_1 | SP_2 | ... | SP_k]</code></pre><p>The GA minimizes the sum of squared errors + penalty:</p><p class="math-container">\[\sum_{k}\sum_{j}\sum_{i}(Data - Simulation)^2\]</p><p>Updating chromosome bound and length is done by <a href="references.html#TSCPDetector.update_bounds!-NTuple{5, Any}"><code>TSCPDetector.update_bounds!</code></a> function.</p><hr/><h2 id="Iterative-Process"><a class="docs-heading-anchor" href="#Iterative-Process">Iterative Process</a><a id="Iterative-Process-1"></a><a class="docs-heading-anchor-permalink" href="#Iterative-Process" title="Permalink"></a></h2><ol><li><p><strong>Initialization</strong>:</p><ul><li>Assume no change points.</li><li>Optimize global model using GA.</li></ul></li><li><p><strong>Segmentation Proposals</strong>:</p><ul><li>Sweep the current segment with a window.</li><li>Try introducing a change point at each valid <code>j</code>.</li></ul></li><li><p><strong>Evaluation</strong>:</p><ul><li>Run GA for each candidate segment split.</li><li>If adding a change point reduces loss significantly, accept it.</li></ul></li><li><p><strong>Chromosome Update</strong>:</p><ul><li>Expand the chromosome.</li><li>Re-optimize.</li></ul></li><li><p><strong>Repeat</strong>:</p><ul><li>Recurse into new segments using updated change points.</li><li>Stop when no more beneficial change points can be found.</li></ul></li></ol><hr/><h2 id="Penalty-Functions"><a class="docs-heading-anchor" href="#Penalty-Functions">Penalty Functions</a><a id="Penalty-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Penalty-Functions" title="Permalink"></a></h2><p>To avoid overfitting, Mocha uses customizable penalty functions. Some built-in examples:</p><ul><li><code>default_penalty(p, n) = 2 * p * log(n)</code></li><li><code>imbalance_penalty(p, n, CP)</code> penalizes unbalanced segment lengths.</li></ul><p>Users can define their own functions and pass them into the API.</p><hr/><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>Mocha is built to detect <strong>true structural changes</strong> in modeled time series systems. It:</p><ul><li>Supports custom models (ODEs, Difference, Regression)</li><li>Detects changepoints via shifts in model parameters</li><li>Uses evolutionary optimization for parameter fitting</li><li>Can incorporate penalties and constraints for robust results</li></ul><p>The modular design ensures you can plug in your own models, loss functions, and penalty strategies while taking advantage of Mocha&#39;s powerful changepoint detection engine.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="problems.html">¬´ Problem types</a><a class="docs-footer-nextpage" href="examples.html">Examples ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 15 July 2025 10:00">Tuesday 15 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
